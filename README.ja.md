# SeatingChartMaker

Version 0.1.0

![SeatingChartMaker](/images/SeatingChartMaker.gif)

## 目次

1. [概要](#%e6%a6%82%e8%a6%81)
1. [特徴](#%e7%89%b9%e5%be%b4)
1. [初期設定](#%e5%88%9d%e6%9c%9f%e8%a8%ad%e5%ae%9a)
1. [使い方](#%e4%bd%bf%e3%81%84%e6%96%b9)
1. [注意点](#%e6%b3%a8%e6%84%8f%e7%82%b9)
1. [License](#License)


## 概要

Excel ファイル上で座席表を作成するマクロです。**席替え用のマクロではなく、既にできている名簿から座席表を作るマクロです。** 課外授業や総合的な探究の時間などで使用する、その日限りの座席表を複数枚作成する場合に役立つと思います。


## 特徴

- 参加者の名前や番号などを貼り付けて2回クリックするだけで座席表が作成可能
- コンテキストメニューから使用可能
- 使用禁止席を指定可能
- 座席表の形式がある程度柔軟

座席表の2つ右の列に参加者の名前や番号などを貼り付けて、コンテキストメニュー（右クリックメニュー）から操作するだけで座席表ができます。

使用禁止席を指定できます。座席の左上のセルに **"x"（小文字のエックス）を半角で入力してください**。

座席表や各座席の範囲の指定は、セルアドレスではなく罫線で行っています。そのためルールに従って罫線を引けば、座席表の形式をある程度自由に設定できます。


## 初期設定

1. `main.bas` をダウンロード
1. モジュールをインポート、または先頭行を除いてコピー & ペースト
1. Thisworkbook モジュールに以下のコードを追加  
    ```
    Private Sub Workbook_Open()
        Call AddToContextMenu
    End Sub
    ```
1. ファイルを `.xlsm` 形式で保存
1. ファイルを開き直す


## 使い方

1. 罫線を引いて座席表を作成してください
1. 参加者を、座席表の2つ右の列に入力してください
![罫線について](/images/SeatingChartMaker01.png)
1. 適当なセルを右クリックして、メニューから操作してください


## 注意点

- 座席と座席表の範囲は、罫線で識別しています。以下のように罫線を引いてください。
    - 座席表の外枠に、途切れることなく罫線を引いてください
    ![罫線について](/images/SeatingChartMaker02.png)
    - 座席表の範囲を越えた余分な罫線を引かないでください
    ![罫線について](/images/SeatingChartMaker03.png)
    - 座席ひとつひとつは途切れることなく罫線で区切ってください
    ![罫線について](/images/SeatingChartMaker04.png)
    - 座席内に罫線を引かないでください
    - それぞれの座席の行数や列数を同じにしてください
    ![罫線について](/images/SeatingChartMaker05.png)
- 参加者は、座席表の一番右上のセルから、右に2つずれたセルから下に入力してください（そのセルを含む）。座席表の範囲が `B3:M16` だった場合、一番右上は `L3` ですので、その2つ右の `O3` から下、つまり`O3`, `O4`, `O5` ... に入力してください。
![参加者の入力位置について](/images/SeatingChartMaker01.png)
- それぞれの座席の一番左上のセルに参加者を入力します。それ以外のセルに対しては一切入力しません。`VLOOKUP` 関数等を入れてお使いください。
- 座席表は、シート1枚につきひとつのみにしてください。


## License

Copyright 2022 taidalog

SeatingChartMaker is licensed under the MIT License.
